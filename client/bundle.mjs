(()=>{"use strict";class t{constructor(t,n,a,e,i){const s=document.createElement("canvas");s.width=a,s.height=e;const o=s.getContext("2d");if(!o)throw new Error("[canvas-test.canvas] cannot get 2d-context of inner-canvas");this._front={canvas:t,context:n},this._back={canvas:s,context:o},this._canvasInfo={width:a,height:e},this._fps=Math.floor(i),this._updateFunction=null,this._startFrame=0,this._animationId=null,this._intervalId=null}_flip(){this._animationId=null,this._front.context.fillStyle="#000",this._front.context.fillRect(0,0,this._front.canvas.width,this._front.canvas.height),this._front.context.drawImage(this._back.canvas,0,0,this._canvasInfo.width,this._canvasInfo.height,0,0,this._front.canvas.width,this._front.canvas.height)}_everyFrame(){this._updateFunction&&(this._back.context.fillStyle="#000",this._back.context.fillRect(0,0,this._canvasInfo.width,this._canvasInfo.height),this._updateFunction({context:this._back.context,frame:Math.floor(performance.now()*this._fps/1e3)-this._startFrame,width:this._canvasInfo.width,height:this._canvasInfo.height})),null!==this._animationId&&window.cancelAnimationFrame(this._animationId),window.requestAnimationFrame((()=>this._flip()))}setUpdate(t,n){return!(this._updateFunction&&!n||(this._updateFunction=t,0))}start(){null===this._intervalId&&(this._startFrame=Math.floor(performance.now()*this._fps/1e3),this._intervalId=window.setInterval((()=>this._everyFrame()),1e3/this._fps))}stop(){null!==this._intervalId&&window.clearInterval(this._intervalId)}}const n=["aaa","aaf","afa","faa","aff","ffa","faf","fff"];let a=0;const e={top:0,left:0},i={horizontal:1,vertical:1},s=t=>{const s=t.context;e.top+=3*i.vertical,e.left+=3*i.horizontal;let o=!1;e.top>t.height-50&&(e.top-=2*(e.top-t.height+50),i.vertical=-1,o=!0),e.top<0&&(e.top*=-1,i.vertical=1,o=!0),e.left>t.width-326&&(e.left-=2*(e.left-t.width+326),i.horizontal=-1,o=!0),e.left<0&&(e.left+=-1,i.horizontal=1,o=!0),o&&(a++,a==n.length&&(a=0)),s.fillStyle=`#${n[a]}`,s.font="48pt serif",s.fillText("Windows11",e.left,e.top+50)};window.addEventListener("load",(async()=>{console.log("[canvas-test]","onload...");const n=document.querySelector("div#game-frame > canvas");if(!n)throw new Error("[canvas-test] canvas element is not exist");const a=n.getContext("2d");if(!a)throw new Error("[canva-test] 2d-context of canvas element is not exist");a.fillStyle="#000",a.fillRect(0,0,1200,720);const e=new t(n,a,1200,720,60);e.setUpdate(s),e.start()}))})();